import fs from 'fs';
import express from 'express';
import { authenticate } from './middleware.js';
import userManager from './user_manager.js';

// _have_bea
// aW5kZXguanM=

const router = express.Router();

router.post('/captcha_text', (request, response) => {
    if (!request.body) {
        return response.json({ message: 'Invalid input! Please try again!' });
    }

    const redactedWords = request.body.redactedWords;
    const userAnswers = request.body.userAnswers;

    if (!redactedWords || !userAnswers || redactedWords.length !== userAnswers.length) {
        return response.json({ message: 'Invalid input! Please try again!' });
    }

    // Compare each redacted word with the corresponding user input
    let allCorrect = true;
    for (let i = 0; i < redactedWords.length; i++) {
        if (redactedWords[i].toLowerCase() !== userAnswers[i].toLowerCase()) {
            allCorrect = false;
            break;
        }
    }

    if (allCorrect) {
        return response.json({ message: 'flag{f1rst_fl4g_0f_th3-d4y!}' });
    } else {
        return response.json({ message: 'Some answers are incorrect. Try again.' });
    }
});

let pixels = [2910,2911,2912,2913,2914,2915,2916,3084,3085,3086,3087,3088,3110,3111,3112,3113,3114,3115,3116,3117,3281,3282,3283,3284,3285,3286,3287,3288,3309,3310,3311,3312,3313,3314,3315,3316,3317,3323,3324,3325,3326,3481,3482,3483,3484,3485,3486,3487,3488,3489,3509,3510,3511,3512,3514,3515,3516,3517,3523,3524,3525,3526,3527,3528,3529,3674,3675,3681,3682,3683,3684,3686,3687,3688,3689,3709,3710,3711,3712,3714,3715,3716,3717,3722,3723,3724,3725,3726,3727,3728,3729,3730,3871,3872,3873,3874,3875,3876,3881,3882,3883,3884,3886,3887,3888,3889,3909,3910,3911,3912,3913,3914,3915,3916,3917,3922,3923,3924,3925,3927,3928,3929,3930,3936,4070,4071,4072,4073,4074,4075,4076,4082,4083,4084,4086,4087,4088,4089,4109,4110,4111,4112,4113,4114,4115,4116,4117,4122,4123,4124,4125,4127,4128,4129,4130,4136,4137,4138,4269,4270,4271,4272,4273,4274,4282,4283,4284,4285,4287,4288,4289,4290,4309,4310,4311,4312,4313,4314,4315,4316,4322,4323,4324,4326,4327,4328,4329,4335,4336,4337,4338,4340,4470,4471,4472,4473,4482,4483,4484,4485,4487,4488,4489,4490,4495,4496,4497,4509,4510,4511,4512,4521,4522,4523,4524,4526,4527,4528,4529,4535,4536,4537,4538,4539,4540,4541,4542,4670,4671,4672,4673,4682,4683,4684,4685,4686,4687,4688,4689,4690,4695,4696,4697,4709,4710,4711,4721,4722,4723,4724,4726,4727,4728,4729,4735,4736,4737,4739,4740,4741,4742,4744,4870,4871,4872,4873,4874,4883,4884,4885,4886,4887,4888,4889,4890,4895,4896,4897,4909,4910,4911,4921,4922,4923,4924,4925,4926,4927,4928,4929,4934,4935,4936,4937,4938,4939,4940,4941,4942,4943,4944,4945,4946,5071,5072,5073,5074,5078,5083,5084,5085,5086,5087,5088,5089,5121,5122,5123,5124,5125,5126,5127,5128,5134,5135,5136,5137,5138,5139,5140,5141,5143,5144,5145,5146,5271,5272,5273,5274,5276,5277,5278,5279,5283,5284,5285,5321,5322,5323,5324,5325,5326,5327,5328,5333,5334,5335,5336,5337,5338,5339,5340,5341,5342,5343,5344,5345,5472,5473,5474,5475,5476,5477,5478,5479,5525,5526,5527,5528,5533,5534,5535,5536,5537,5538,5539,5540,5541,5542,5543,5544,5672,5673,5674,5675,5676,5677,5678,5733,5734,5735,5736,5737,5738,5739,5740,5741,5742,5743,5744,5750,5751,5752,5853,5854,5872,5873,5874,5875,5932,5933,5934,5935,5936,5937,5938,5939,5940,5941,5942,5943,5950,5951,5952,5953,6052,6053,6054,6055,6134,6135,6136,6138,6139,6140,6141,6142,6149,6150,6151,6152,6153,6154,6155,6250,6251,6252,6253,6254,6255,6338,6339,6340,6341,6342,6348,6349,6350,6351,6352,6353,6354,6355,6356,6449,6450,6451,6452,6453,6454,6455,6456,6538,6539,6540,6541,6547,6548,6549,6550,6551,6553,6554,6555,6556,6648,6649,6650,6651,6652,6653,6654,6655,6656,6657,6740,6741,6747,6748,6749,6750,6751,6752,6755,6848,6849,6850,6851,6852,6854,6855,6856,6857,6946,6947,6948,6949,6950,6951,6952,6953,6954,7049,7050,7051,7052,7053,7054,7055,7056,7057,7058,7116,7117,7118,7119,7120,7121,7122,7123,7145,7146,7147,7148,7149,7151,7152,7153,7161,7250,7251,7252,7253,7254,7255,7256,7257,7258,7259,7260,7314,7315,7316,7317,7318,7319,7320,7321,7322,7323,7324,7325,7345,7346,7347,7348,7349,7352,7360,7361,7362,7443,7450,7451,7452,7453,7454,7456,7457,7458,7459,7460,7512,7513,7514,7515,7516,7517,7518,7519,7520,7521,7522,7523,7524,7525,7526,7546,7547,7548,7549,7550,7551,7559,7560,7561,7562,7563,7642,7643,7644,7651,7652,7653,7654,7655,7657,7658,7659,7711,7712,7713,7714,7715,7716,7717,7718,7719,7720,7721,7722,7723,7724,7725,7726,7727,7748,7749,7750,7751,7752,7758,7759,7760,7761,7762,7763,7764,7842,7843,7844,7845,7852,7853,7854,7855,7856,7875,7876,7877,7878,7879,7880,7881,7882,7883,7884,7885,7911,7912,7913,7914,7915,7916,7917,7918,7919,7920,7921,7922,7923,7924,7925,7926,7927,7928,7929,7930,7949,7950,7951,7957,7958,7959,7960,7961,7962,7963,7964,7965,8041,8042,8043,8044,8046,8053,8054,8055,8056,8072,8073,8074,8075,8076,8077,8078,8079,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8110,8111,8112,8113,8114,8115,8116,8117,8118,8119,8120,8121,8122,8123,8124,8125,8126,8127,8128,8129,8130,8131,8132,8133,8134,8156,8157,8158,8159,8160,8162,8163,8164,8165,8166,8240,8241,8242,8243,8245,8246,8247,8254,8255,8270,8271,8272,8273,8274,8275,8276,8277,8278,8279,8280,8281,8282,8283,8284,8285,8286,8287,8288,8289,8290,8291,8309,8310,8311,8312,8313,8314,8315,8316,8317,8318,8319,8320,8321,8322,8323,8324,8325,8326,8327,8328,8329,8330,8331,8332,8333,8334,8335,8336,8354,8355,8356,8357,8358,8359,8360,8361,8362,8363,8364,8365,8439,8440,8441,8442,8443,8444,8445,8446,8447,8469,8470,8471,8472,8473,8474,8475,8476,8477,8478,8479,8480,8481,8482,8483,8484,8485,8486,8487,8488,8489,8490,8491,8492,8493,8509,8510,8511,8512,8513,8514,8515,8516,8517,8518,8519,8520,8521,8522,8523,8524,8525,8526,8527,8528,8529,8530,8531,8532,8533,8534,8535,8536,8537,8553,8554,8555,8556,8557,8558,8559,8560,8561,8562,8563,8564,8565,8640,8641,8642,8643,8644,8645,8646,8647,8649,8650,8668,8669,8670,8671,8672,8673,8674,8675,8685,8686,8687,8688,8689,8690,8691,8692,8693,8694,8695,8709,8710,8711,8712,8713,8714,8715,8716,8717,8718,8719,8720,8721,8722,8723,8724,8730,8731,8732,8733,8734,8735,8736,8737,8738,8739,8754,8755,8756,8757,8759,8760,8761,8762,8763,8764,8841,8842,8843,8844,8845,8846,8848,8849,8850,8851,8867,8868,8869,8870,8871,8872,8873,8888,8889,8890,8891,8892,8893,8894,8895,8896,8897,8909,8910,8911,8912,8913,8914,8915,8916,8917,8918,8919,8920,8921,8922,8923,8924,8933,8934,8935,8936,8937,8938,8939,8940,8955,8956,8958,8959,8960,8961,8962,8963,8970,9042,9043,9044,9045,9046,9047,9048,9049,9050,9066,9067,9068,9069,9070,9071,9091,9092,9093,9094,9095,9096,9097,9098,9099,9108,9109,9110,9111,9112,9113,9114,9115,9116,9117,9118,9119,9120,9121,9122,9123,9124,9135,9136,9137,9138,9139,9140,9141,9157,9158,9159,9160,9169,9170,9235,9243,9244,9245,9246,9247,9248,9249,9265,9266,9267,9268,9269,9270,9278,9279,9280,9281,9282,9293,9294,9295,9296,9297,9298,9299,9300,9307,9308,9309,9310,9311,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9322,9323,9324,9337,9338,9339,9340,9341,9357,9358,9359,9360,9367,9368,9369,9370,9371,9435,9436,9444,9445,9446,9447,9448,9464,9465,9466,9467,9468,9469,9475,9476,9477,9478,9479,9480,9481,9482,9483,9484,9485,9486,9495,9496,9497,9498,9499,9500,9501,9502,9505,9506,9507,9508,9509,9510,9511,9512,9515,9516,9517,9518,9519,9520,9521,9522,9523,9524,9525,9526,9527,9528,9529,9530,9531,9538,9539,9540,9541,9542,9558,9559,9560,9566,9567,9568,9569,9570,9571,9634,9635,9636,9637,9645,9646,9647,9664,9665,9666,9667,9668,9674,9675,9676,9677,9678,9679,9680,9681,9682,9683,9684,9685,9686,9687,9688,9697,9698,9699,9700,9701,9702,9703,9704,9705,9706,9707,9708,9709,9710,9711,9715,9716,9717,9718,9719,9720,9721,9722,9723,9724,9725,9726,9727,9728,9729,9730,9731,9732,9733,9739,9740,9741,9742,9743,9759,9765,9766,9767,9768,9769,9770,9834,9835,9836,9837,9838,9839,9846,9847,9863,9864,9865,9866,9867,9872,9873,9874,9875,9876,9877,9878,9879,9880,9881,9882,9883,9884,9885,9886,9887,9888,9889,9890,9891,9898,9899,9900,9901,9902,9903,9904,9905,9906,9907,9908,9909,9916,9917,9918,9919,9920,9921,9922,9923,9924,9925,9926,9927,9928,9929,9930,9931,9932,9933,9934,9939,9940,9941,9942,9943,9964,9965,9966,9967,9968,9969,10033,10035,10036,10037,10038,10039,10040,10063,10064,10065,10066,10067,10072,10073,10074,10075,10076,10077,10078,10079,10080,10081,10082,10083,10084,10085,10086,10087,10088,10089,10090,10091,10092,10099,10100,10101,10102,10103,10104,10105,10106,10107,10108,10115,10116,10117,10118,10119,10120,10121,10122,10123,10124,10125,10126,10127,10128,10129,10130,10131,10132,10133,10134,10135,10140,10141,10142,10143,10144,10162,10163,10164,10165,10166,10167,10232,10233,10234,10235,10237,10238,10239,10240,10241,10262,10263,10264,10265,10266,10271,10272,10273,10274,10275,10276,10277,10278,10279,10280,10281,10282,10283,10284,10285,10286,10287,10288,10289,10290,10291,10292,10293,10294,10301,10302,10303,10304,10305,10306,10313,10314,10315,10316,10317,10318,10319,10320,10321,10322,10323,10324,10325,10326,10327,10328,10329,10330,10331,10332,10333,10334,10335,10336,10340,10341,10342,10343,10344,10362,10363,10364,10365,10366,10375,10431,10432,10433,10434,10435,10436,10437,10438,10439,10440,10441,10442,10462,10463,10464,10465,10466,10470,10471,10472,10473,10474,10475,10476,10477,10478,10479,10480,10481,10482,10483,10484,10485,10486,10487,10488,10489,10490,10491,10492,10493,10494,10495,10496,10502,10503,10504,10505,10511,10512,10513,10514,10515,10516,10517,10518,10519,10520,10521,10522,10523,10524,10525,10526,10527,10528,10529,10530,10531,10532,10533,10534,10535,10536,10541,10542,10543,10544,10563,10564,10565,10574,10575,10632,10633,10634,10635,10636,10637,10638,10639,10640,10641,10642,10643,10662,10663,10664,10665,10670,10671,10672,10673,10674,10675,10676,10677,10678,10679,10680,10681,10682,10683,10684,10685,10686,10687,10688,10689,10690,10691,10692,10693,10694,10695,10696,10697,10703,10704,10710,10711,10712,10713,10714,10715,10716,10717,10718,10719,10720,10721,10722,10723,10724,10725,10726,10727,10728,10729,10730,10731,10732,10733,10734,10735,10736,10737,10741,10742,10743,10744,10745,10763,10764,10772,10773,10774,10775,10776,10830,10831,10832,10833,10834,10835,10836,10837,10838,10839,10840,10841,10842,10861,10862,10863,10864,10865,10869,10870,10871,10872,10873,10874,10875,10876,10877,10878,10879,10880,10881,10882,10883,10884,10885,10886,10887,10888,10889,10890,10891,10892,10893,10894,10895,10896,10897,10898,10909,10910,10911,10912,10913,10914,10915,10916,10917,10918,10919,10920,10921,10922,10923,10924,10925,10926,10927,10928,10929,10930,10931,10932,10933,10934,10935,10936,10937,10942,10943,10944,10945,10970,10971,10972,10973,10974,10975,10976,10977,11029,11030,11031,11032,11033,11034,11035,11036,11037,11039,11040,11041,11042,11061,11062,11063,11064,11065,11069,11070,11071,11072,11073,11074,11075,11076,11077,11078,11079,11080,11081,11082,11083,11084,11085,11086,11087,11088,11089,11090,11091,11092,11093,11094,11095,11096,11097,11098,11099,11100,11107,11108,11109,11110,11111,11112,11113,11114,11115,11116,11117,11118,11119,11120,11121,11122,11123,11124,11125,11126,11127,11128,11129,11130,11131,11132,11133,11134,11135,11136,11137,11138,11142,11143,11144,11145,11168,11169,11170,11171,11172,11173,11174,11175,11176,11229,11230,11231,11232,11233,11234,11235,11236,11237,11238,11239,11241,11261,11262,11263,11264,11269,11270,11271,11272,11273,11274,11275,11276,11277,11278,11279,11280,11281,11282,11283,11284,11285,11286,11287,11288,11289,11290,11291,11292,11293,11294,11295,11296,11297,11298,11299,11300,11307,11308,11309,11310,11311,11312,11313,11314,11315,11316,11317,11318,11319,11320,11321,11322,11323,11324,11325,11326,11327,11328,11329,11330,11331,11332,11333,11334,11335,11336,11337,11338,11342,11343,11344,11345,11346,11367,11368,11369,11370,11371,11372,11373,11374,11375,11377,11378,11431,11432,11433,11434,11435,11436,11437,11438,11439,11440,11461,11462,11463,11464,11469,11470,11471,11472,11473,11474,11475,11476,11477,11478,11479,11480,11481,11482,11483,11484,11485,11486,11487,11488,11489,11490,11491,11492,11493,11494,11495,11496,11497,11498,11499,11508,11509,11510,11511,11512,11513,11514,11515,11516,11517,11518,11519,11520,11521,11522,11523,11524,11525,11526,11527,11528,11529,11530,11531,11532,11533,11534,11535,11536,11537,11538,11542,11543,11544,11545,11546,11566,11567,11568,11569,11570,11571,11572,11573,11574,11575,11576,11577,11578,11633,11634,11635,11636,11637,11638,11639,11640,11661,11662,11663,11664,11668,11669,11670,11671,11672,11673,11674,11675,11676,11677,11678,11679,11680,11681,11682,11683,11684,11685,11686,11687,11688,11689,11690,11691,11692,11693,11694,11695,11696,11697,11698,11709,11710,11711,11712,11713,11714,11715,11716,11717,11718,11719,11720,11721,11722,11723,11724,11725,11726,11727,11728,11729,11730,11731,11732,11733,11734,11735,11736,11737,11738,11743,11744,11745,11746,11767,11768,11769,11770,11771,11772,11773,11774,11775,11776,11777,11778,11779,11835,11836,11837,11838,11839,11861,11862,11863,11864,11868,11869,11870,11871,11872,11873,11874,11875,11876,11877,11878,11879,11880,11881,11882,11883,11884,11885,11886,11887,11888,11889,11890,11891,11892,11893,11894,11895,11896,11897,11903,11904,11910,11911,11912,11913,11914,11915,11916,11917,11918,11919,11920,11921,11922,11923,11924,11925,11926,11927,11928,11929,11930,11931,11932,11933,11934,11935,11936,11937,11938,11943,11944,11945,11946,11967,11970,11971,11972,11973,11974,11975,11976,11977,12037,12038,12039,12060,12061,12062,12063,12064,12068,12069,12070,12071,12072,12073,12074,12075,12076,12077,12078,12079,12080,12081,12082,12083,12084,12085,12086,12087,12088,12089,12090,12091,12092,12093,12094,12095,12096,12102,12103,12104,12105,12111,12112,12113,12114,12115,12116,12117,12118,12119,12120,12121,12122,12123,12124,12125,12126,12127,12128,12129,12130,12131,12132,12133,12134,12135,12136,12137,12138,12139,12143,12144,12145,12146,12169,12170,12171,12172,12173,12174,12175,12176,12227,12260,12261,12262,12263,12264,12268,12269,12270,12271,12272,12273,12274,12275,12276,12277,12278,12279,12280,12281,12282,12283,12284,12285,12286,12287,12288,12289,12290,12291,12292,12293,12294,12295,12301,12302,12303,12304,12305,12306,12312,12313,12314,12315,12316,12317,12318,12319,12320,12321,12322,12323,12324,12325,12326,12327,12328,12329,12330,12331,12332,12333,12334,12335,12336,12337,12338,12339,12343,12344,12345,12346,12369,12370,12371,12372,12373,12374,12426,12427,12428,12429,12430,12460,12461,12462,12463,12464,12468,12469,12470,12471,12472,12473,12474,12475,12476,12477,12478,12479,12480,12481,12482,12483,12484,12485,12486,12487,12488,12489,12490,12491,12492,12493,12494,12500,12501,12502,12503,12504,12505,12506,12507,12513,12514,12515,12516,12517,12518,12519,12520,12521,12522,12523,12524,12525,12526,12527,12528,12529,12530,12531,12532,12533,12534,12535,12536,12537,12538,12539,12543,12544,12545,12546,12569,12570,12571,12572,12625,12626,12627,12628,12629,12630,12631,12632,12660,12661,12662,12663,12664,12668,12669,12670,12671,12672,12673,12674,12675,12676,12677,12678,12679,12680,12681,12682,12683,12684,12685,12686,12687,12688,12689,12690,12691,12692,12693,12699,12700,12701,12702,12703,12704,12705,12706,12707,12708,12714,12715,12716,12717,12718,12719,12720,12721,12722,12723,12724,12725,12726,12727,12728,12729,12730,12731,12732,12733,12734,12735,12736,12737,12738,12739,12743,12744,12745,12746,12770,12771,12825,12826,12827,12828,12829,12830,12831,12832,12833,12834,12860,12861,12862,12863,12868,12869,12870,12871,12872,12873,12874,12875,12876,12877,12878,12879,12880,12881,12882,12883,12884,12885,12886,12887,12888,12889,12890,12891,12892,12898,12899,12900,12901,12902,12903,12904,12905,12906,12907,12908,12909,12915,12916,12917,12918,12919,12920,12921,12922,12923,12924,12925,12926,12927,12928,12929,12930,12931,12932,12933,12934,12935,12936,12937,12938,12939,12943,12944,12945,12946,12979,12980,12981,12982,13024,13025,13026,13027,13028,13029,13030,13031,13032,13033,13034,13035,13060,13061,13062,13063,13068,13069,13070,13071,13072,13073,13074,13075,13076,13077,13078,13079,13080,13081,13082,13083,13084,13085,13086,13087,13088,13089,13090,13091,13097,13098,13099,13100,13101,13102,13103,13104,13105,13106,13107,13108,13109,13110,13115,13116,13117,13118,13119,13120,13121,13122,13123,13124,13125,13126,13127,13128,13129,13130,13131,13132,13133,13134,13135,13136,13137,13138,13139,13143,13144,13145,13146,13176,13177,13178,13179,13180,13181,13182,13224,13225,13226,13227,13230,13231,13232,13233,13234,13235,13260,13261,13262,13263,13264,13268,13269,13270,13271,13272,13273,13274,13275,13276,13277,13278,13279,13280,13281,13282,13283,13284,13285,13286,13287,13288,13289,13290,13291,13296,13297,13298,13299,13300,13301,13302,13303,13304,13305,13306,13307,13308,13309,13310,13311,13316,13317,13318,13319,13320,13321,13322,13323,13324,13325,13326,13327,13328,13329,13330,13331,13332,13333,13334,13335,13336,13337,13338,13339,13343,13344,13345,13346,13373,13374,13375,13376,13377,13378,13379,13380,13381,13382,13383,13424,13425,13426,13427,13428,13429,13432,13433,13434,13435,13460,13461,13462,13463,13464,13468,13469,13470,13471,13472,13473,13474,13475,13476,13477,13478,13479,13480,13481,13482,13483,13484,13485,13486,13487,13488,13489,13490,13495,13496,13497,13498,13499,13500,13501,13502,13503,13504,13505,13506,13507,13508,13509,13510,13511,13512,13517,13518,13519,13520,13521,13522,13523,13524,13525,13526,13527,13528,13529,13530,13531,13532,13533,13534,13535,13536,13537,13538,13539,13543,13544,13545,13546,13572,13573,13574,13575,13576,13577,13578,13579,13580,13581,13582,13583,13624,13625,13626,13627,13628,13629,13630,13631,13632,13633,13634,13660,13661,13662,13663,13664,13668,13669,13670,13671,13672,13673,13674,13675,13676,13677,13678,13679,13680,13681,13682,13683,13684,13685,13686,13687,13688,13689,13694,13695,13696,13697,13698,13699,13700,13701,13702,13703,13704,13705,13706,13707,13708,13709,13710,13711,13712,13713,13718,13719,13720,13721,13722,13723,13724,13725,13726,13727,13728,13729,13730,13731,13732,13733,13734,13735,13736,13737,13738,13739,13743,13744,13745,13746,13772,13773,13774,13775,13776,13777,13778,13781,13782,13783,13825,13826,13827,13828,13829,13830,13831,13832,13833,13834,13860,13861,13862,13863,13864,13868,13869,13870,13871,13872,13873,13874,13875,13876,13877,13878,13879,13880,13881,13882,13883,13884,13885,13886,13887,13888,13919,13920,13921,13922,13923,13924,13925,13926,13927,13928,13929,13930,13931,13932,13933,13934,13935,13936,13937,13938,13939,13943,13944,13945,13946,13973,13974,13975,13979,13982,13983,13984,14028,14029,14030,14031,14032,14033,14061,14062,14063,14064,14068,14069,14070,14071,14072,14073,14074,14075,14076,14077,14078,14079,14080,14081,14082,14083,14124,14125,14126,14127,14128,14129,14130,14131,14132,14133,14134,14135,14136,14137,14138,14139,14143,14144,14145,14146,14173,14174,14175,14176,14177,14178,14179,14182,14183,14184,14230,14231,14232,14233,14261,14262,14263,14264,14268,14269,14270,14271,14272,14273,14274,14275,14276,14277,14329,14330,14331,14332,14333,14334,14335,14336,14337,14338,14343,14344,14345,14346,14374,14375,14376,14377,14378,14379,14380,14460,14461,14462,14463,14464,14468,14469,14470,14471,14472,14473,14498,14499,14500,14501,14502,14503,14504,14505,14506,14507,14508,14509,14534,14535,14536,14537,14538,14543,14544,14545,14546,14574,14575,14576,14577,14578,14579,14580,14658,14659,14660,14661,14662,14663,14664,14669,14690,14691,14692,14693,14694,14695,14696,14697,14698,14699,14700,14701,14702,14703,14704,14705,14706,14707,14708,14709,14710,14711,14712,14713,14714,14715,14716,14717,14738,14742,14743,14744,14745,14746,14747,14748,14749,14774,14775,14776,14777,14778,14821,14822,14823,14824,14825,14856,14857,14858,14859,14860,14861,14862,14863,14864,14880,14881,14882,14883,14884,14890,14891,14892,14893,14894,14895,14896,14897,14898,14899,14900,14901,14902,14903,14904,14905,14906,14907,14908,14909,14910,14911,14912,14913,14914,14915,14916,14917,14922,14923,14924,14925,14926,14942,14943,14944,14945,14946,14947,14948,14949,14950,14951,14975,15021,15022,15023,15024,15025,15026,15027,15028,15054,15055,15056,15057,15058,15059,15060,15061,15062,15063,15076,15077,15078,15079,15080,15081,15082,15083,15084,15089,15090,15091,15092,15093,15094,15095,15096,15097,15098,15099,15100,15101,15102,15103,15104,15105,15106,15107,15108,15109,15110,15111,15112,15113,15114,15115,15116,15117,15118,15123,15124,15125,15126,15127,15128,15129,15130,15131,15144,15145,15146,15147,15148,15149,15150,15151,15152,15153,15221,15222,15223,15224,15225,15226,15227,15228,15252,15253,15254,15255,15256,15257,15258,15259,15260,15261,15272,15273,15274,15275,15276,15277,15278,15279,15280,15281,15282,15283,15288,15289,15290,15291,15292,15293,15294,15295,15296,15297,15298,15299,15300,15301,15302,15303,15304,15305,15306,15307,15308,15309,15310,15311,15312,15313,15314,15315,15316,15317,15318,15319,15324,15325,15326,15327,15328,15329,15330,15331,15332,15333,15334,15335,15346,15347,15348,15349,15350,15351,15352,15353,15354,15420,15421,15422,15423,15424,15425,15426,15427,15451,15452,15453,15454,15455,15456,15457,15458,15469,15470,15471,15472,15473,15474,15475,15476,15477,15478,15479,15480,15481,15482,15487,15488,15489,15490,15491,15492,15493,15494,15495,15496,15497,15498,15499,15500,15501,15502,15503,15504,15505,15506,15509,15510,15511,15512,15513,15514,15515,15516,15517,15518,15519,15524,15525,15526,15527,15528,15529,15530,15531,15532,15533,15534,15535,15536,15537,15548,15549,15550,15551,15552,15553,15554,15555,15556,15620,15621,15622,15625,15626,15627,15649,15650,15651,15652,15653,15654,15655,15656,15670,15671,15672,15673,15674,15675,15676,15677,15678,15679,15680,15681,15682,15687,15688,15689,15690,15691,15692,15693,15694,15695,15696,15697,15698,15699,15700,15701,15702,15703,15704,15708,15709,15710,15711,15712,15713,15714,15715,15716,15717,15718,15719,15720,15725,15726,15727,15728,15729,15730,15731,15732,15733,15734,15735,15736,15737,15750,15751,15752,15753,15754,15755,15756,15757,15758,15820,15821,15822,15823,15824,15825,15826,15827,15848,15849,15850,15851,15852,15853,15854,15863,15864,15865,15870,15871,15872,15873,15874,15875,15876,15877,15878,15879,15880,15881,15886,15887,15888,15889,15906,15907,15908,15909,15913,15914,15915,15916,15917,15918,15919,15920,15921,15926,15927,15928,15929,15930,15931,15932,15933,15934,15935,15936,15937,15941,15942,15943,15944,15952,15953,15954,15955,15956,15957,15958,15959,16020,16021,16022,16023,16024,16025,16026,16027,16028,16029,16030,16047,16048,16049,16050,16051,16052,16053,16061,16062,16063,16064,16065,16066,16070,16071,16072,16073,16074,16075,16076,16077,16078,16079,16080,16085,16086,16087,16088,16089,16090,16105,16106,16107,16108,16109,16114,16115,16116,16117,16118,16119,16120,16121,16126,16127,16128,16129,16130,16131,16132,16133,16134,16135,16136,16137,16141,16142,16143,16144,16145,16146,16154,16155,16156,16157,16158,16159,16160,16219,16220,16221,16222,16223,16224,16225,16226,16227,16228,16229,16230,16245,16246,16247,16248,16249,16250,16251,16259,16260,16261,16262,16263,16264,16265,16266,16270,16271,16272,16273,16274,16275,16276,16277,16278,16279,16280,16285,16286,16287,16288,16290,16304,16305,16306,16307,16308,16317,16318,16319,16320,16321,16322,16327,16328,16329,16330,16331,16332,16333,16334,16335,16336,16341,16342,16343,16344,16345,16346,16347,16348,16355,16356,16357,16358,16359,16360,16361,16423,16424,16425,16426,16427,16428,16429,16430,16444,16445,16446,16447,16448,16449,16450,16457,16458,16459,16460,16461,16462,16463,16464,16465,16466,16471,16472,16473,16474,16475,16476,16477,16478,16479,16484,16485,16486,16487,16488,16503,16504,16505,16506,16507,16508,16516,16518,16519,16520,16521,16522,16523,16528,16529,16530,16531,16532,16533,16534,16535,16536,16541,16542,16543,16544,16545,16546,16547,16548,16549,16550,16557,16558,16559,16560,16561,16562,16628,16629,16643,16644,16645,16646,16647,16648,16649,16655,16656,16657,16658,16659,16660,16661,16662,16663,16664,16665,16666,16671,16672,16673,16674,16675,16676,16677,16678,16679,16684,16685,16686,16687,16688,16702,16703,16704,16705,16706,16707,16708,16715,16719,16720,16721,16722,16723,16728,16729,16730,16731,16732,16733,16734,16735,16736,16740,16741,16742,16743,16744,16745,16746,16747,16748,16749,16750,16751,16758,16759,16760,16761,16762,16763,16843,16844,16845,16846,16847,16854,16855,16856,16857,16858,16859,16860,16861,16862,16863,16864,16865,16866,16867,16871,16872,16873,16874,16875,16876,16877,16878,16883,16884,16885,16886,16887,16888,16890,16901,16902,16903,16904,16905,16906,16907,16908,16916,16919,16920,16921,16922,16923,16924,16929,16930,16931,16932,16933,16934,16935,16940,16941,16942,16943,16944,16945,16946,16947,16948,16949,16950,16951,16952,16953,16959,16960,16961,16962,16963,16964,17042,17043,17044,17045,17046,17052,17053,17054,17055,17056,17057,17058,17059,17060,17061,17062,17063,17064,17065,17066,17067,17072,17073,17074,17075,17076,17077,17082,17083,17084,17085,17086,17087,17088,17096,17100,17101,17102,17103,17104,17105,17106,17107,17116,17120,17121,17122,17123,17124,17129,17130,17131,17132,17133,17134,17135,17140,17141,17142,17143,17144,17145,17146,17147,17148,17149,17150,17151,17152,17153,17154,17160,17161,17162,17163,17164,17165,17241,17242,17243,17244,17245,17251,17252,17253,17254,17255,17256,17257,17258,17259,17260,17261,17262,17263,17264,17265,17266,17267,17272,17273,17274,17275,17276,17277,17282,17283,17284,17285,17286,17287,17288,17298,17299,17300,17301,17302,17303,17304,17305,17306,17307,17308,17320,17321,17322,17323,17324,17325,17330,17331,17332,17333,17334,17335,17339,17340,17341,17342,17343,17344,17345,17346,17347,17348,17349,17350,17351,17352,17353,17354,17355,17361,17362,17363,17364,17365,17441,17442,17443,17444,17445,17450,17451,17452,17453,17454,17455,17456,17457,17458,17459,17460,17461,17462,17463,17464,17465,17466,17467,17468,17472,17473,17474,17475,17476,17481,17482,17483,17484,17485,17486,17487,17488,17497,17498,17499,17500,17501,17502,17503,17504,17505,17506,17507,17508,17509,17521,17522,17523,17524,17525,17526,17530,17531,17532,17533,17534,17535,17539,17540,17541,17542,17543,17544,17545,17546,17547,17548,17549,17550,17551,17552,17553,17554,17555,17556,17562,17563,17564,17565,17566,17586,17587,17588,17640,17641,17642,17643,17644,17649,17650,17651,17652,17653,17654,17655,17656,17657,17658,17659,17660,17661,17662,17663,17664,17665,17666,17667,17668,17673,17674,17675,17676,17681,17682,17683,17684,17685,17686,17687,17688,17697,17698,17699,17700,17701,17702,17703,17704,17705,17706,17707,17708,17709,17710,17721,17722,17723,17724,17725,17726,17731,17732,17733,17734,17739,17740,17741,17742,17743,17744,17745,17746,17747,17748,17749,17750,17751,17752,17753,17754,17755,17756,17757,17763,17764,17765,17766,17767,17786,17787,17788,17840,17841,17842,17843,17848,17849,17850,17851,17852,17853,17854,17855,17856,17857,17858,17859,17860,17861,17862,17863,17864,17865,17866,17867,17868,17873,17874,17875,17880,17881,17882,17883,17884,17885,17886,17887,17888,17899,17900,17901,17902,17903,17904,17905,17906,17907,17908,17909,17910,17911,17912,17921,17922,17923,17924,17925,17926,17927,17931,17932,17933,17934,17938,17939,17940,17941,17942,17943,17944,17945,17946,17947,17948,17949,17950,17951,17952,17953,17954,17955,17956,17957,17958,17963,17964,17965,17966,17967,17981,17982,17983,17984,17985,17986,17987,17988,18039,18040,18041,18042,18043,18048,18049,18050,18051,18052,18053,18054,18055,18056,18057,18058,18059,18060,18061,18062,18063,18064,18065,18066,18067,18068,18069,18073,18074,18075,18080,18081,18082,18083,18084,18085,18086,18087,18088,18100,18101,18102,18103,18104,18105,18106,18107,18108,18109,18110,18111,18112,18113,18121,18122,18123,18124,18125,18126,18127,18132,18133,18138,18139,18140,18141,18142,18143,18144,18145,18146,18147,18148,18149,18150,18151,18152,18153,18154,18155,18156,18157,18158,18159,18164,18165,18166,18167,18178,18179,18180,18181,18182,18183,18184,18185,18186,18187,18188,18239,18240,18241,18242,18247,18248,18249,18250,18251,18252,18253,18254,18255,18256,18257,18258,18259,18260,18261,18262,18263,18264,18265,18266,18267,18268,18269,18274,18279,18280,18281,18282,18283,18284,18285,18286,18287,18288,18302,18303,18304,18305,18306,18307,18308,18309,18310,18311,18312,18313,18321,18322,18323,18324,18325,18326,18327,18328,18333,18338,18339,18340,18341,18342,18343,18344,18345,18346,18347,18348,18349,18350,18351,18352,18353,18354,18355,18356,18357,18358,18359,18360,18364,18365,18366,18367,18368,18378,18379,18380,18381,18382,18383,18384,18385,18386,18387,18388,18439,18440,18441,18442,18447,18448,18449,18450,18451,18452,18453,18454,18455,18456,18457,18458,18459,18460,18461,18462,18463,18464,18465,18466,18467,18468,18469,18474,18479,18480,18481,18482,18483,18484,18485,18486,18487,18488,18503,18504,18505,18506,18507,18508,18509,18510,18511,18512,18521,18522,18523,18524,18525,18526,18527,18528,18533,18537,18538,18539,18540,18541,18542,18543,18544,18545,18546,18547,18548,18549,18550,18551,18552,18553,18554,18555,18556,18557,18558,18559,18560,18565,18566,18567,18568,18578,18579,18580,18581,18582,18583,18584,18585,18586,18587,18588,18638,18639,18640,18641,18642,18646,18647,18648,18649,18650,18651,18652,18653,18654,18655,18656,18657,18658,18659,18660,18661,18662,18663,18664,18665,18666,18667,18668,18669,18670,18678,18679,18680,18681,18682,18683,18684,18685,18686,18687,18688,18703,18704,18705,18706,18707,18708,18709,18710,18711,18720,18721,18722,18723,18724,18725,18726,18727,18728,18729,18737,18738,18739,18740,18741,18742,18743,18744,18745,18746,18747,18748,18749,18750,18751,18752,18753,18754,18755,18756,18757,18758,18759,18760,18765,18766,18767,18768,18787,18788,18789,18838,18839,18840,18841,18846,18847,18848,18849,18850,18851,18852,18853,18854,18855,18856,18857,18858,18859,18860,18861,18862,18863,18864,18865,18866,18867,18868,18869,18870,18878,18879,18880,18881,18882,18883,18884,18885,18886,18887,18888,18903,18904,18905,18906,18907,18908,18909,18920,18921,18922,18923,18924,18925,18926,18927,18928,18929,18937,18938,18939,18940,18941,18942,18943,18944,18945,18946,18947,18948,18949,18950,18951,18952,18953,18954,18955,18956,18957,18958,18959,18960,18961,18965,18966,18967,18968,18987,18988,18989,19038,19039,19040,19041,19046,19047,19048,19049,19050,19051,19052,19053,19054,19055,19056,19057,19058,19059,19060,19061,19062,19063,19064,19065,19066,19067,19068,19069,19070,19071,19077,19078,19079,19080,19081,19082,19083,19084,19085,19086,19087,19088,19102,19103,19104,19105,19106,19107,19108,19120,19121,19122,19123,19124,19125,19126,19127,19128,19129,19130,19136,19137,19138,19139,19140,19141,19142,19143,19144,19145,19146,19147,19148,19149,19150,19151,19152,19153,19154,19155,19156,19157,19158,19159,19160,19161,19165,19166,19167,19168,19169,19238,19239,19240,19241,19246,19247,19248,19249,19250,19251,19252,19253,19254,19255,19256,19257,19258,19259,19260,19261,19262,19263,19264,19265,19266,19267,19268,19269,19270,19271,19277,19278,19279,19280,19281,19282,19283,19284,19285,19286,19287,19288,19302,19303,19304,19305,19306,19307,19318,19319,19320,19321,19322,19323,19324,19325,19326,19327,19328,19329,19330,19336,19337,19338,19339,19340,19341,19342,19343,19344,19345,19346,19347,19348,19349,19350,19351,19352,19353,19354,19355,19356,19357,19358,19359,19360,19361,19365,19366,19367,19368,19369,19427,19428,19438,19439,19440,19441,19446,19447,19448,19449,19450,19451,19452,19453,19454,19455,19456,19457,19458,19459,19460,19461,19462,19463,19464,19465,19466,19467,19468,19469,19470,19471,19476,19477,19478,19479,19480,19481,19482,19483,19484,19485,19486,19487,19488,19489,19490,19502,19503,19504,19505,19506,19516,19518,19519,19520,19521,19522,19523,19524,19525,19526,19527,19528,19529,19530,19531,19535,19536,19537,19538,19539,19540,19541,19542,19543,19544,19545,19546,19547,19548,19549,19550,19551,19552,19553,19554,19555,19556,19557,19558,19559,19560,19561,19565,19566,19567,19568,19569,19618,19619,19620,19621,19622,19623,19624,19625,19626,19627,19628,19638,19639,19640,19641,19646,19647,19648,19649,19650,19651,19652,19653,19654,19655,19656,19657,19658,19659,19660,19661,19662,19663,19664,19665,19666,19667,19668,19669,19670,19671,19677,19678,19679,19680,19681,19682,19683,19684,19685,19686,19687,19688,19690,19691,19692,19701,19702,19703,19704,19705,19718,19719,19720,19721,19722,19723,19724,19725,19726,19727,19728,19729,19730,19736,19737,19738,19739,19740,19741,19742,19743,19744,19745,19746,19747,19748,19749,19750,19751,19752,19753,19754,19755,19756,19757,19758,19759,19760,19761,19765,19766,19767,19768,19769,19818,19819,19820,19821,19822,19823,19824,19825,19826,19827,19828,19838,19839,19840,19841,19842,19846,19847,19848,19849,19850,19851,19852,19853,19854,19855,19856,19857,19858,19859,19860,19861,19862,19863,19864,19865,19866,19867,19868,19869,19870,19871,19877,19878,19879,19880,19881,19882,19883,19884,19885,19886,19887,19888,19901,19902,19903,19904,19917,19918,19919,19920,19921,19922,19923,19924,19925,19926,19927,19928,19929,19930,19936,19937,19938,19939,19940,19941,19942,19943,19944,19945,19946,19947,19948,19949,19950,19951,19952,19953,19954,19955,19956,19957,19958,19959,19960,19961,19965,19966,19967,19968,19979,19980,19981,19982,19983,19984,19985,19986,19987,19988,19989,20018,20019,20020,20021,20022,20023,20024,20025,20026,20027,20028,20039,20040,20041,20042,20046,20047,20048,20049,20050,20051,20052,20053,20054,20055,20056,20057,20058,20059,20060,20061,20062,20063,20064,20065,20066,20067,20068,20069,20070,20078,20079,20080,20081,20082,20083,20084,20085,20086,20087,20088,20100,20101,20102,20115,20116,20117,20118,20119,20120,20121,20122,20123,20124,20125,20126,20127,20128,20129,20137,20138,20139,20140,20141,20142,20143,20144,20145,20146,20147,20148,20149,20150,20151,20152,20153,20154,20155,20156,20157,20158,20159,20160,20165,20166,20167,20168,20179,20180,20181,20182,20183,20184,20185,20186,20187,20188,20189,20218,20219,20220,20223,20224,20225,20226,20239,20240,20241,20242,20247,20248,20249,20250,20251,20252,20253,20254,20255,20256,20257,20258,20259,20260,20261,20262,20263,20264,20265,20266,20267,20268,20269,20270,20278,20279,20280,20281,20282,20283,20284,20285,20286,20287,20288,20300,20301,20314,20315,20316,20317,20318,20319,20320,20321,20322,20323,20324,20325,20326,20327,20328,20329,20337,20338,20339,20340,20341,20342,20343,20344,20345,20346,20347,20348,20349,20350,20351,20352,20353,20354,20355,20356,20357,20358,20359,20360,20364,20365,20366,20367,20368,20378,20379,20380,20381,20382,20383,20384,20385,20386,20387,20388,20389,20418,20419,20420,20421,20422,20423,20424,20425,20426,20427,20428,20439,20440,20441,20442,20443,20447,20448,20449,20450,20451,20452,20453,20454,20455,20456,20457,20458,20459,20460,20461,20462,20463,20464,20465,20466,20467,20468,20469,20474,20479,20480,20481,20482,20483,20484,20485,20486,20487,20488,20499,20500,20508,20509,20515,20516,20517,20518,20519,20520,20521,20522,20523,20524,20525,20526,20527,20528,20533,20537,20538,20539,20540,20541,20542,20543,20544,20545,20546,20547,20548,20549,20550,20551,20552,20553,20554,20555,20556,20557,20558,20559,20564,20565,20566,20567,20568,20583,20584,20585,20586,20587,20588,20589,20618,20619,20620,20621,20622,20623,20624,20625,20626,20627,20628,20639,20640,20641,20642,20643,20648,20649,20650,20651,20652,20653,20654,20655,20656,20657,20658,20659,20660,20661,20662,20663,20664,20665,20666,20667,20668,20669,20674,20679,20680,20681,20682,20683,20684,20685,20686,20687,20688,20699,20700,20701,20702,20703,20705,20710,20715,20716,20717,20718,20719,20720,20721,20722,20723,20724,20725,20726,20727,20728,20732,20733,20738,20739,20740,20741,20742,20743,20744,20745,20746,20747,20748,20749,20750,20751,20752,20753,20754,20755,20756,20757,20758,20759,20764,20765,20766,20767,20778,20779,20780,20781,20782,20783,20784,20785,20818,20819,20820,20821,20822,20823,20824,20825,20826,20827,20828,20840,20841,20842,20843,20844,20849,20850,20855,20856,20857,20858,20859,20860,20861,20862,20863,20864,20865,20866,20867,20868,20869,20873,20874,20875,20880,20881,20882,20883,20884,20885,20886,20887,20888,20899,20900,20901,20902,20903,20904,20908,20916,20917,20918,20919,20920,20921,20922,20923,20924,20925,20926,20927,20932,20933,20938,20939,20940,20941,20942,20943,20944,20945,20946,20947,20948,20949,20950,20951,20952,20953,20954,20955,20956,20957,20958,20963,20964,20965,20966,20967,20978,20979,20980,20981,20982,20983,20984,20985,20986,20987,20988,21018,21019,21020,21021,21022,21023,21024,21025,21026,21027,21028,21040,21041,21042,21043,21044,21056,21057,21058,21059,21060,21061,21062,21063,21064,21065,21066,21067,21068,21073,21074,21075,21080,21081,21082,21083,21084,21085,21086,21087,21088,21092,21099,21100,21101,21102,21103,21104,21117,21118,21119,21120,21121,21122,21123,21124,21125,21126,21127,21131,21132,21133,21134,21138,21139,21140,21141,21142,21143,21144,21145,21146,21147,21148,21149,21150,21151,21152,21153,21154,21155,21156,21157,21162,21163,21164,21165,21166,21178,21179,21180,21181,21182,21183,21184,21185,21186,21187,21188,21241,21242,21243,21244,21245,21257,21258,21259,21260,21261,21262,21263,21264,21265,21266,21267,21268,21273,21274,21275,21276,21281,21282,21283,21284,21285,21286,21287,21288,21299,21300,21301,21302,21303,21304,21305,21317,21318,21319,21320,21321,21322,21323,21324,21325,21326,21331,21332,21333,21334,21339,21340,21341,21342,21343,21344,21345,21346,21347,21348,21349,21350,21351,21352,21353,21354,21355,21356,21362,21363,21364,21365,21366,21378,21379,21380,21381,21382,21383,21384,21385,21386,21387,21388,21441,21442,21443,21444,21445,21446,21458,21459,21460,21461,21462,21463,21464,21465,21466,21467,21468,21472,21473,21474,21475,21476,21481,21482,21483,21484,21485,21486,21487,21488,21499,21500,21501,21502,21503,21504,21505,21506,21518,21519,21520,21521,21522,21523,21524,21525,21526,21530,21531,21532,21533,21534,21535,21539,21540,21541,21542,21543,21544,21545,21546,21547,21548,21549,21550,21551,21552,21553,21554,21555,21561,21562,21563,21564,21565,21641,21642,21643,21644,21645,21646,21658,21659,21660,21661,21662,21663,21664,21665,21666,21667,21672,21673,21674,21675,21676,21677,21682,21683,21684,21685,21686,21687,21688,21699,21700,21701,21702,21703,21704,21705,21706,21719,21720,21721,21722,21723,21724,21725,21730,21731,21732,21733,21734,21735,21739,21740,21741,21742,21743,21744,21745,21746,21747,21748,21749,21750,21751,21752,21753,21760,21761,21762,21763,21764,21828,21841,21842,21843,21844,21845,21846,21858,21859,21860,21861,21862,21863,21864,21865,21866,21867,21872,21873,21874,21875,21876,21877,21878,21882,21883,21884,21885,21886,21887,21888,21890,21891,21899,21900,21901,21902,21903,21904,21905,21906,21907,21910,21911,21919,21920,21921,21922,21923,21924,21929,21930,21931,21932,21933,21934,21935,21940,21941,21942,21943,21944,21945,21946,21947,21948,21949,21950,21951,21952,21959,21960,21961,21962,21963,21964,22024,22025,22026,22027,22028,22029,22041,22042,22043,22044,22045,22046,22047,22058,22059,22060,22061,22062,22063,22064,22065,22066,22067,22071,22072,22073,22074,22075,22076,22077,22078,22083,22084,22085,22086,22087,22088,22091,22093,22098,22099,22100,22101,22102,22103,22104,22105,22106,22107,22108,22109,22120,22121,22122,22123,22124,22129,22130,22131,22132,22133,22134,22135,22136,22140,22141,22142,22143,22144,22145,22146,22147,22148,22149,22150,22157,22158,22159,22160,22161,22162,22163,22177,22178,22220,22221,22222,22223,22224,22225,22226,22227,22228,22229,22242,22243,22244,22245,22246,22247,22258,22259,22260,22261,22262,22263,22264,22265,22266,22271,22272,22273,22274,22275,22276,22277,22278,22279,22284,22285,22286,22287,22288,22299,22300,22301,22302,22303,22304,22305,22306,22307,22308,22309,22314,22315,22316,22321,22322,22323,22328,22329,22330,22331,22332,22333,22334,22335,22336,22340,22341,22342,22343,22344,22345,22346,22347,22348,22349,22356,22357,22358,22359,22360,22361,22362,22377,22378,22379,22380,22381,22382,22419,22420,22421,22422,22423,22424,22425,22426,22427,22428,22429,22430,22442,22443,22444,22445,22446,22447,22448,22460,22461,22462,22463,22464,22465,22466,22471,22472,22473,22474,22475,22476,22477,22478,22479,22484,22485,22486,22487,22488,22499,22500,22501,22502,22503,22504,22505,22506,22507,22508,22509,22513,22514,22515,22516,22517,22518,22521,22522,22523,22527,22528,22529,22530,22531,22532,22533,22534,22535,22536,22541,22542,22543,22544,22545,22546,22547,22555,22556,22557,22558,22559,22560,22561,22577,22578,22579,22580,22581,22582,22583,22584,22585,22586,22619,22620,22621,22622,22623,22624,22625,22626,22628,22629,22630,22642,22643,22644,22645,22646,22647,22648,22649,22662,22663,22664,22665,22666,22670,22671,22672,22673,22674,22675,22676,22677,22678,22679,22680,22685,22686,22687,22688,22689,22698,22699,22700,22701,22702,22703,22704,22705,22706,22707,22708,22709,22710,22711,22712,22713,22714,22715,22716,22717,22718,22719,22720,22721,22722,22727,22728,22729,22730,22731,22732,22733,22734,22735,22736,22741,22742,22743,22744,22745,22753,22754,22755,22756,22757,22758,22759,22777,22778,22779,22780,22781,22782,22783,22784,22785,22786,22787,22819,22820,22821,22822,22827,22828,22829,22830,22843,22844,22845,22846,22847,22848,22849,22850,22851,22854,22855,22864,22865,22866,22870,22871,22872,22873,22874,22875,22876,22877,22878,22879,22880,22881,22886,22887,22888,22889,22890,22891,22892,22893,22894,22895,22896,22897,22898,22899,22900,22901,22902,22903,22904,22905,22906,22907,22908,22909,22910,22911,22912,22913,22914,22915,22916,22917,22918,22919,22920,22921,22926,22927,22928,22929,22930,22931,22932,22933,22934,22935,22936,22937,22941,22942,22951,22952,22953,22954,22955,22956,22957,22958,22976,22977,22978,22979,22980,22981,22982,22983,22984,22985,22986,22987,23020,23021,23022,23023,23024,23025,23026,23027,23028,23029,23030,23043,23044,23045,23046,23047,23048,23049,23050,23051,23052,23053,23054,23055,23056,23057,23070,23071,23072,23073,23074,23075,23076,23077,23078,23079,23080,23081,23086,23087,23088,23089,23090,23091,23092,23093,23094,23095,23096,23097,23098,23099,23100,23101,23102,23103,23104,23105,23106,23107,23108,23109,23110,23111,23112,23113,23114,23115,23116,23117,23118,23119,23120,23121,23126,23127,23128,23129,23130,23131,23132,23133,23134,23135,23136,23137,23149,23150,23151,23152,23153,23154,23155,23156,23157,23176,23177,23178,23181,23182,23183,23184,23185,23186,23187,23220,23221,23222,23223,23224,23225,23226,23227,23228,23229,23230,23244,23245,23246,23247,23248,23249,23250,23251,23252,23253,23254,23255,23256,23257,23258,23259,23260,23270,23271,23272,23273,23274,23275,23276,23277,23278,23279,23280,23281,23282,23287,23288,23289,23290,23291,23292,23293,23294,23295,23296,23297,23298,23299,23300,23301,23302,23303,23304,23305,23306,23307,23308,23309,23310,23311,23312,23313,23314,23315,23316,23317,23318,23319,23320,23325,23326,23327,23328,23329,23330,23331,23332,23333,23334,23335,23336,23347,23348,23349,23350,23351,23352,23353,23354,23355,23376,23377,23378,23380,23381,23382,23384,23385,23386,23387,23420,23421,23422,23423,23424,23425,23426,23427,23428,23429,23430,23445,23446,23447,23448,23449,23450,23451,23452,23453,23454,23455,23456,23457,23458,23459,23460,23461,23462,23474,23475,23476,23477,23478,23479,23480,23481,23482,23488,23489,23490,23491,23492,23493,23494,23495,23496,23497,23498,23499,23500,23501,23502,23503,23504,23505,23506,23507,23508,23509,23510,23511,23512,23513,23514,23515,23516,23517,23518,23519,23524,23525,23526,23527,23528,23529,23530,23531,23532,23533,23545,23546,23547,23548,23549,23550,23551,23552,23553,23576,23577,23578,23580,23581,23582,23584,23585,23586,23620,23621,23622,23623,23624,23625,23646,23647,23648,23649,23650,23651,23652,23653,23654,23655,23656,23657,23658,23659,23660,23661,23662,23663,23664,23665,23678,23679,23680,23681,23682,23683,23688,23689,23690,23691,23692,23693,23694,23695,23696,23697,23698,23699,23700,23701,23702,23703,23704,23705,23706,23707,23708,23709,23710,23711,23712,23713,23714,23715,23716,23717,23718,23719,23724,23725,23726,23727,23728,23729,23742,23743,23744,23745,23746,23747,23748,23749,23750,23751,23752,23782,23784,23785,23786,23848,23849,23850,23851,23852,23853,23854,23855,23856,23857,23858,23859,23860,23861,23862,23863,23864,23865,23884,23889,23890,23891,23892,23893,23894,23895,23896,23897,23898,23899,23900,23901,23902,23903,23904,23905,23906,23907,23908,23909,23910,23911,23912,23913,23914,23915,23916,23917,23918,23923,23942,23943,23944,23945,23946,23947,23948,23949,23950,23985,23986,24032,24059,24060,24061,24062,24063,24064,24069,24070,24071,24092,24093,24094,24095,24096,24097,24098,24099,24100,24101,24102,24103,24104,24105,24106,24107,24108,24109,24110,24111,24112,24113,24114,24115,24135,24136,24137,24138,24142,24143,24144,24145,24146,24147,24148,24230,24231,24232,24261,24262,24263,24264,24269,24270,24271,24272,24273,24274,24275,24331,24332,24333,24334,24335,24336,24337,24338,24342,24343,24344,24345,24346,24430,24431,24432,24461,24462,24463,24464,24468,24469,24470,24471,24472,24473,24474,24475,24476,24477,24478,24479,24480,24526,24527,24528,24529,24530,24531,24532,24533,24534,24535,24536,24537,24538,24543,24544,24545,24546,24631,24632,24633,24661,24662,24663,24664,24668,24669,24670,24671,24672,24673,24674,24675,24676,24677,24678,24679,24680,24681,24682,24683,24684,24685,24686,24687,24720,24721,24722,24723,24724,24725,24726,24727,24728,24729,24730,24731,24732,24733,24734,24735,24736,24737,24738,24743,24744,24745,24746,24822,24823,24824,24825,24826,24827,24828,24831,24832,24833,24861,24862,24863,24864,24868,24869,24870,24871,24872,24873,24874,24875,24876,24877,24878,24879,24880,24881,24882,24883,24884,24885,24886,24887,24893,24894,24895,24896,24897,24898,24899,24900,24901,24902,24903,24904,24905,24906,24907,24908,24909,24910,24911,24912,24913,24914,24919,24920,24921,24922,24923,24924,24925,24926,24927,24928,24929,24930,24931,24932,24933,24934,24935,24936,24937,24938,24939,24943,24944,24945,24946,25023,25024,25025,25026,25027,25028,25029,25030,25031,25032,25033,25034,25060,25061,25062,25063,25064,25068,25069,25070,25071,25072,25073,25074,25075,25076,25077,25078,25079,25080,25081,25082,25083,25084,25085,25086,25087,25088,25094,25095,25096,25097,25098,25099,25100,25101,25102,25103,25104,25105,25106,25107,25108,25109,25110,25111,25112,25113,25119,25120,25121,25122,25123,25124,25125,25126,25127,25128,25129,25130,25131,25132,25133,25134,25135,25136,25137,25138,25139,25143,25144,25145,25146,25223,25224,25225,25226,25227,25228,25229,25230,25231,25232,25233,25234,25260,25261,25262,25263,25264,25268,25269,25270,25271,25272,25273,25274,25275,25276,25277,25278,25279,25280,25281,25282,25283,25284,25285,25286,25287,25288,25289,25294,25295,25296,25297,25298,25299,25300,25301,25302,25303,25304,25305,25306,25307,25308,25309,25310,25311,25312,25313,25318,25319,25320,25321,25322,25323,25324,25325,25326,25327,25328,25329,25330,25331,25332,25333,25334,25335,25336,25337,25338,25339,25343,25344,25345,25346,25423,25424,25425,25426,25428,25429,25430,25431,25432,25433,25434,25460,25461,25462,25463,25464,25468,25469,25470,25471,25472,25473,25474,25475,25476,25477,25478,25479,25480,25481,25482,25483,25484,25485,25486,25487,25488,25489,25490,25495,25496,25497,25498,25499,25500,25501,25502,25503,25504,25505,25506,25507,25508,25509,25510,25511,25512,25517,25518,25519,25520,25521,25522,25523,25524,25525,25526,25527,25528,25529,25530,25531,25532,25533,25534,25535,25536,25537,25538,25539,25543,25544,25545,25546,25624,25625,25626,25631,25632,25633,25660,25661,25662,25663,25664,25668,25669,25670,25671,25672,25673,25674,25675,25676,25677,25678,25679,25680,25681,25682,25683,25684,25685,25686,25687,25688,25689,25690,25691,25696,25697,25698,25699,25700,25701,25702,25703,25704,25705,25706,25707,25708,25709,25710,25711,25716,25717,25718,25719,25720,25721,25722,25723,25724,25725,25726,25727,25728,25729,25730,25731,25732,25733,25734,25735,25736,25737,25738,25739,25743,25744,25745,25746,25824,25825,25826,25860,25861,25862,25863,25868,25869,25870,25871,25872,25873,25874,25875,25876,25877,25878,25879,25880,25881,25882,25883,25884,25885,25886,25887,25888,25889,25890,25891,25897,25898,25899,25900,25901,25902,25903,25904,25905,25906,25907,25908,25909,25910,25915,25916,25917,25918,25919,25920,25921,25922,25923,25924,25925,25926,25927,25928,25929,25930,25931,25932,25933,25934,25935,25936,25937,25938,25939,25943,25944,25945,25946,26024,26025,26026,26036,26060,26061,26062,26063,26068,26069,26070,26071,26072,26073,26074,26075,26076,26077,26078,26079,26080,26081,26082,26083,26084,26085,26086,26087,26088,26089,26090,26091,26092,26098,26099,26100,26101,26102,26103,26104,26105,26106,26107,26108,26109,26115,26116,26117,26118,26119,26120,26121,26122,26123,26124,26125,26126,26127,26128,26129,26130,26131,26132,26133,26134,26135,26136,26137,26138,26139,26143,26144,26145,26146,26147,26171,26225,26235,26236,26260,26261,26262,26263,26264,26268,26269,26270,26271,26272,26273,26274,26275,26276,26277,26278,26279,26280,26281,26282,26283,26284,26285,26286,26287,26288,26289,26290,26291,26292,26293,26299,26300,26301,26302,26303,26304,26305,26306,26307,26308,26314,26315,26316,26317,26318,26319,26320,26321,26322,26323,26324,26325,26326,26327,26328,26329,26330,26331,26332,26333,26334,26335,26336,26337,26338,26339,26343,26344,26345,26346,26347,26348,26370,26371,26372,26373,26433,26434,26435,26436,26437,26460,26461,26462,26463,26464,26468,26469,26470,26471,26472,26473,26474,26475,26476,26477,26478,26479,26480,26481,26482,26483,26484,26485,26486,26487,26488,26489,26490,26491,26492,26493,26494,26500,26501,26502,26503,26504,26505,26506,26507,26513,26514,26515,26516,26517,26518,26519,26520,26521,26522,26523,26524,26525,26526,26527,26528,26529,26530,26531,26532,26533,26534,26535,26536,26537,26538,26539,26543,26544,26545,26546,26547,26548,26570,26571,26572,26573,26574,26575,26632,26633,26634,26635,26636,26637,26660,26661,26662,26663,26664,26668,26669,26670,26671,26672,26673,26674,26675,26676,26677,26678,26679,26680,26681,26682,26683,26684,26685,26686,26687,26688,26689,26690,26691,26692,26693,26694,26695,26701,26702,26703,26704,26705,26706,26712,26713,26714,26715,26716,26717,26718,26719,26720,26721,26722,26723,26724,26725,26726,26727,26728,26729,26730,26731,26732,26733,26734,26735,26736,26737,26738,26739,26743,26744,26745,26746,26747,26748,26749,26770,26771,26772,26773,26774,26775,26776,26777,26831,26832,26833,26834,26835,26836,26860,26861,26862,26863,26864,26868,26869,26870,26871,26872,26873,26874,26875,26876,26877,26878,26879,26880,26881,26882,26883,26884,26885,26886,26887,26888,26889,26890,26891,26892,26893,26894,26895,26896,26902,26903,26904,26905,26911,26912,26913,26914,26915,26916,26917,26918,26919,26920,26921,26922,26923,26924,26925,26926,26927,26928,26929,26930,26931,26932,26933,26934,26935,26936,26937,26938,26939,26940,26941,26942,26943,26944,26945,26946,26947,26948,26949,26972,26973,26974,26975,26976,26977,26978,26979,27030,27031,27032,27033,27034,27035,27036,27038,27039,27061,27062,27063,27064,27068,27069,27070,27071,27072,27073,27074,27075,27076,27077,27078,27079,27080,27081,27082,27083,27084,27085,27086,27087,27088,27089,27090,27091,27092,27093,27094,27095,27096,27097,27103,27104,27110,27111,27112,27113,27114,27115,27116,27117,27118,27119,27120,27121,27122,27123,27124,27125,27126,27127,27128,27129,27130,27131,27132,27133,27134,27135,27136,27137,27138,27139,27140,27141,27142,27143,27144,27145,27146,27147,27148,27149,27150,27172,27173,27174,27175,27176,27177,27178,27179,27180,27228,27229,27230,27231,27232,27233,27234,27235,27236,27237,27238,27239,27261,27262,27263,27264,27268,27269,27270,27271,27272,27273,27274,27275,27276,27277,27278,27279,27280,27281,27282,27283,27284,27285,27286,27287,27288,27289,27290,27291,27292,27293,27294,27295,27296,27297,27298,27309,27310,27311,27312,27313,27314,27315,27316,27317,27318,27319,27320,27321,27322,27323,27324,27325,27326,27327,27328,27329,27330,27331,27332,27333,27334,27335,27336,27337,27338,27339,27340,27341,27342,27343,27344,27345,27346,27347,27348,27349,27350,27372,27373,27374,27375,27376,27377,27378,27379,27428,27429,27430,27431,27432,27433,27434,27435,27436,27437,27438,27439,27440,27461,27462,27463,27464,27469,27470,27471,27472,27473,27474,27475,27476,27477,27478,27479,27480,27481,27482,27483,27484,27485,27486,27487,27488,27489,27490,27491,27492,27493,27494,27495,27496,27497,27498,27499,27508,27509,27510,27511,27512,27513,27514,27515,27516,27517,27518,27519,27520,27521,27522,27523,27524,27525,27526,27527,27528,27529,27530,27531,27532,27533,27534,27535,27536,27537,27538,27539,27540,27541,27542,27543,27544,27545,27546,27547,27548,27549,27550,27571,27572,27573,27574,27576,27577,27578,27579,27628,27629,27630,27631,27632,27633,27634,27635,27636,27637,27638,27639,27661,27662,27663,27664,27669,27670,27671,27672,27673,27674,27675,27676,27677,27678,27679,27680,27681,27682,27683,27684,27685,27686,27687,27688,27689,27690,27691,27692,27693,27694,27695,27696,27697,27698,27699,27700,27707,27708,27709,27710,27711,27712,27713,27714,27715,27716,27717,27718,27719,27720,27721,27722,27723,27724,27725,27726,27727,27728,27729,27730,27731,27732,27733,27734,27735,27736,27737,27738,27739,27740,27741,27742,27743,27744,27745,27746,27747,27748,27749,27750,27772,27773,27776,27777,27778,27829,27830,27831,27832,27833,27834,27835,27836,27837,27861,27862,27863,27864,27865,27869,27870,27871,27872,27873,27874,27875,27876,27877,27878,27879,27880,27881,27882,27883,27884,27885,27886,27887,27888,27889,27890,27891,27892,27893,27894,27895,27896,27897,27898,27899,27908,27909,27910,27911,27912,27913,27914,27915,27916,27917,27918,27919,27920,27921,27922,27923,27924,27925,27926,27927,27928,27929,27930,27931,27932,27933,27934,27935,27936,27937,27938,27939,27940,27941,27942,27943,27944,27945,27946,27947,27948,27949,27950,27975,27976,27977,27978,28030,28031,28032,28033,28034,28062,28063,28064,28065,28069,28070,28071,28072,28073,28074,28075,28076,28077,28078,28079,28080,28081,28082,28083,28084,28085,28086,28087,28088,28089,28090,28091,28092,28093,28094,28095,28096,28097,28098,28109,28110,28111,28112,28113,28114,28115,28116,28117,28118,28119,28120,28121,28122,28123,28124,28125,28126,28127,28128,28129,28130,28131,28132,28133,28134,28135,28136,28137,28138,28139,28140,28141,28142,28143,28144,28145,28146,28147,28148,28149,28150,28165,28166,28167,28175,28176,28177,28230,28231,28232,28241,28242,28243,28262,28263,28264,28265,28270,28271,28272,28273,28274,28275,28276,28277,28278,28279,28280,28281,28282,28283,28284,28285,28286,28287,28288,28289,28290,28291,28292,28293,28294,28295,28296,28297,28303,28304,28310,28311,28312,28313,28314,28315,28316,28317,28318,28319,28320,28321,28322,28323,28324,28325,28326,28327,28328,28329,28330,28331,28332,28333,28334,28335,28336,28337,28338,28339,28340,28341,28342,28343,28344,28345,28346,28347,28348,28349,28350,28364,28365,28366,28367,28368,28377,28441,28442,28443,28462,28463,28464,28465,28466,28470,28471,28472,28473,28474,28475,28476,28477,28478,28479,28480,28481,28482,28483,28484,28485,28486,28487,28488,28489,28490,28491,28492,28493,28494,28495,28502,28503,28504,28505,28512,28513,28514,28515,28516,28517,28518,28519,28520,28521,28522,28523,28524,28525,28526,28527,28528,28529,28530,28531,28532,28533,28534,28535,28536,28537,28538,28539,28540,28541,28542,28543,28544,28545,28546,28547,28548,28549,28550,28563,28564,28565,28566,28567,28568,28569,28640,28641,28642,28643,28644,28663,28664,28665,28666,28671,28672,28673,28674,28675,28676,28677,28678,28679,28680,28681,28682,28683,28684,28685,28686,28687,28688,28689,28690,28691,28692,28693,28694,28701,28702,28703,28704,28705,28706,28713,28714,28715,28716,28717,28718,28719,28720,28721,28722,28723,28724,28725,28726,28727,28728,28729,28730,28731,28732,28733,28734,28735,28736,28738,28739,28740,28741,28742,28743,28744,28745,28746,28747,28748,28749,28762,28763,28764,28765,28766,28767,28768,28769,28770,28771,28838,28839,28840,28841,28842,28843,28845,28863,28864,28865,28866,28867,28872,28873,28874,28875,28876,28877,28878,28879,28880,28881,28882,28883,28884,28885,28886,28887,28888,28889,28890,28891,28892,28899,28900,28901,28902,28903,28904,28905,28906,28907,28908,28915,28916,28917,28918,28919,28920,28921,28922,28923,28924,28925,28926,28927,28928,28929,28930,28931,28932,28933,28934,28935,28940,28941,28942,28943,28944,28945,28946,28947,28948,28949,28961,28962,28963,28964,28967,28968,28969,28970,28971,28972,29036,29037,29038,29039,29040,29041,29042,29044,29045,29046,29063,29064,29065,29066,29067,29073,29074,29075,29076,29077,29078,29079,29080,29081,29082,29083,29084,29085,29086,29087,29088,29089,29090,29098,29099,29100,29101,29102,29103,29104,29105,29106,29107,29108,29109,29117,29118,29119,29120,29121,29122,29123,29124,29125,29126,29127,29128,29129,29130,29131,29132,29133,29134,29139,29140,29141,29142,29143,29144,29145,29146,29147,29148,29161,29162,29163,29164,29165,29168,29169,29170,29171,29172,29173,29235,29236,29237,29238,29239,29240,29241,29242,29243,29244,29245,29246,29247,29264,29265,29266,29267,29268,29274,29275,29276,29277,29278,29279,29280,29281,29282,29283,29284,29285,29286,29287,29288,29296,29297,29298,29299,29300,29301,29302,29303,29304,29305,29306,29307,29308,29309,29310,29311,29319,29320,29321,29322,29323,29324,29325,29326,29327,29328,29329,29330,29331,29332,29333,29338,29339,29340,29341,29342,29343,29344,29345,29346,29347,29361,29362,29363,29364,29365,29366,29367,29369,29370,29371,29372,29373,29435,29436,29437,29438,29439,29440,29441,29442,29443,29444,29445,29446,29447,29464,29465,29466,29467,29468,29469,29475,29476,29477,29478,29479,29480,29481,29482,29483,29484,29485,29486,29495,29496,29497,29498,29499,29500,29501,29506,29507,29508,29509,29510,29511,29512,29522,29523,29524,29525,29526,29527,29528,29529,29530,29531,29538,29539,29540,29541,29542,29543,29544,29545,29546,29563,29564,29565,29566,29567,29568,29571,29572,29635,29636,29637,29638,29640,29641,29642,29643,29644,29645,29665,29666,29667,29668,29669,29670,29679,29680,29681,29693,29694,29695,29696,29697,29698,29699,29700,29707,29708,29709,29710,29711,29712,29713,29714,29736,29737,29738,29739,29740,29741,29742,29743,29744,29745,29764,29765,29766,29767,29768,29769,29770,29772,29836,29837,29838,29839,29840,29841,29842,29843,29844,29866,29867,29868,29869,29870,29871,29891,29892,29893,29894,29895,29896,29897,29898,29899,29908,29909,29910,29911,29912,29913,29914,29915,29916,29917,29935,29936,29937,29938,29939,29940,29941,29942,29943,29966,29967,29968,29969,29970,29971,30036,30037,30038,30039,30040,30041,30042,30043,30067,30068,30069,30070,30071,30072,30073,30088,30089,30090,30091,30092,30093,30094,30095,30096,30097,30110,30111,30112,30113,30114,30115,30116,30117,30118,30119,30133,30134,30135,30136,30137,30138,30139,30140,30156,30157,30167,30168,30169,30170,30237,30238,30239,30240,30241,30251,30252,30268,30269,30270,30271,30272,30273,30274,30275,30276,30284,30285,30286,30287,30288,30289,30290,30291,30292,30293,30294,30295,30312,30313,30314,30315,30316,30317,30318,30319,30320,30321,30322,30323,30324,30329,30330,30331,30332,30333,30334,30335,30336,30337,30338,30355,30356,30357,30358,30368,30369,30438,30439,30440,30451,30452,30453,30469,30470,30471,30472,30473,30474,30475,30476,30477,30478,30479,30480,30481,30482,30483,30484,30485,30486,30487,30488,30489,30490,30491,30492,30493,30514,30515,30516,30517,30518,30519,30520,30521,30522,30523,30524,30525,30526,30527,30528,30529,30530,30531,30532,30533,30534,30535,30536,30537,30555,30556,30557,30558,30559,30639,30649,30650,30651,30652,30653,30654,30671,30672,30673,30674,30675,30676,30677,30678,30679,30680,30681,30682,30683,30684,30685,30686,30687,30688,30689,30690,30691,30716,30717,30718,30719,30720,30721,30722,30723,30724,30725,30726,30727,30728,30729,30730,30731,30732,30733,30734,30735,30736,30756,30757,30758,30759,30760,30847,30848,30849,30850,30851,30852,30853,30872,30873,30874,30875,30876,30877,30878,30879,30880,30881,30882,30883,30884,30885,30886,30887,30888,30889,30919,30920,30921,30922,30923,30924,30925,30926,30927,30928,30929,30930,30931,30932,30933,30934,30957,30958,30959,30960,30961,30964,31045,31046,31047,31048,31049,31050,31051,31052,31076,31077,31078,31079,31080,31081,31082,31083,31084,31124,31125,31126,31127,31128,31129,31158,31159,31160,31161,31162,31163,31164,31165,31243,31244,31245,31246,31247,31248,31249,31250,31251,31349,31350,31351,31359,31360,31361,31362,31363,31364,31365,31443,31444,31445,31446,31447,31449,31450,31451,31547,31548,31549,31550,31551,31560,31561,31562,31563,31564,31644,31645,31646,31648,31649,31650,31651,31746,31747,31748,31749,31750,31751,31752,31759,31760,31761,31762,31763,31845,31847,31848,31849,31850,31945,31946,31947,31948,31949,31950,31951,31952,31953,31959,31960,31961,31962,32047,32048,32049,32050,32144,32145,32146,32147,32148,32150,32151,32152,32153,32160,32161,32247,32248,32249,32250,32345,32346,32347,32348,32351,32352,32353,32354,32448,32449,32539,32540,32545,32546,32547,32548,32549,32551,32552,32553,32554,32555,32667,32668,32669,32737,32738,32739,32740,32741,32746,32747,32748,32749,32750,32752,32753,32754,32755,32756,32867,32868,32869,32870,32935,32936,32938,32939,32940,32941,32947,32948,32949,32950,32951,32953,32954,32955,32956,33066,33067,33068,33069,33072,33073,33074,33133,33134,33135,33136,33138,33139,33140,33141,33142,33148,33149,33150,33151,33153,33154,33266,33267,33268,33269,33270,33271,33272,33273,33274,33275,33333,33334,33335,33336,33337,33339,33340,33341,33342,33348,33349,33350,33351,33352,33466,33467,33468,33469,33470,33471,33472,33473,33474,33528,33529,33534,33535,33536,33537,33538,33539,33540,33541,33542,33543,33549,33550,33551,33552,33666,33667,33668,33669,33670,33671,33672,33673,33674,33678,33679,33680,33681,33682,33683,33724,33725,33726,33727,33728,33729,33735,33736,33737,33738,33739,33740,33741,33742,33743,33750,33865,33866,33867,33868,33869,33870,33871,33872,33873,33878,33879,33880,33881,33882,33883,33884,33885,33886,33923,33924,33925,33926,33927,33928,33929,33930,33935,33936,33937,33938,33939,33940,33941,33942,33943,34065,34066,34067,34068,34069,34070,34071,34072,34078,34079,34080,34081,34082,34083,34084,34085,34086,34091,34092,34123,34124,34125,34126,34127,34128,34129,34130,34135,34136,34137,34138,34139,34141,34142,34143,34144,34265,34266,34267,34268,34269,34270,34271,34278,34279,34280,34283,34284,34285,34290,34291,34292,34293,34294,34295,34296,34297,34304,34305,34306,34307,34323,34324,34327,34328,34329,34330,34336,34337,34338,34339,34340,34341,34342,34343,34344,34464,34465,34466,34467,34468,34469,34470,34471,34477,34478,34479,34480,34482,34483,34484,34485,34490,34491,34492,34493,34494,34495,34496,34497,34498,34504,34505,34506,34507,34525,34526,34527,34528,34529,34530,34531,34537,34538,34539,34540,34541,34542,34543,34665,34666,34667,34668,34669,34670,34677,34678,34679,34680,34682,34683,34684,34685,34690,34691,34692,34693,34694,34695,34696,34697,34698,34704,34705,34706,34707,34725,34726,34727,34728,34729,34730,34731,34737,34738,34739,34740,34741,34867,34868,34869,34877,34878,34879,34880,34882,34883,34884,34890,34891,34892,34893,34895,34896,34897,34904,34905,34906,34907,34925,34926,34927,34928,34929,34930,34931,34937,34938,34939,35076,35077,35078,35079,35081,35082,35083,35084,35090,35091,35092,35094,35095,35096,35097,35104,35105,35106,35107,35125,35129,35130,35131,35132,35276,35277,35278,35279,35280,35281,35282,35283,35284,35290,35291,35292,35294,35295,35296,35297,35304,35305,35306,35307,35326,35327,35328,35329,35330,35331,35332,35476,35477,35478,35479,35480,35481,35482,35483,35484,35489,35490,35491,35492,35494,35495,35496,35497,35504,35505,35506,35507,35526,35527,35528,35529,35530,35531,35532,35678,35679,35680,35681,35682,35683,35689,35690,35691,35692,35694,35695,35696,35697,35704,35705,35706,35707,35726,35727,35728,35729,35881,35882,35883,35889,35890,35891,35892,35893,35894,35895,35896,35897,35902,35903,35904,35905,35906,35907,35908,35909,35926,36089,36090,36091,36092,36093,36094,36095,36096,36097,36102,36103,36104,36105,36106,36107,36108,36109,36292,36293,36294,36295,36296,36302,36303,36304,36305,36306,36307,36308,36309]

router.post('/captcha_image', (request, response) => {
    if (!request.body || !Array.isArray(request.body) || request.body.length === 0) {
        return response.json({ message: 'Invalid input! Please try again!' });
    }

    let matches = true;
    for (let i = 0; i < pixels.length; i++) {
        if (request.body[i] !== pixels[i]) matches = false;
    }

    if (matches) {
        return response.json({ message: 'flag{pr33ty_c0l0rs!!!}' });
    } else {
        return response.json({ message: 'Some pixels are missing. Try again.' });
    }
});

router.post('/stage1/check', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else if (!request.body || !Array.isArray(request.body) || request.body.length === 0) {
        response.status(200).json({ flag: 'I don\'t like cheaters! Do it right!' });
    } else {
        const answer = [
            'ArrowUp',   'ArrowUp',
            'ArrowDown', 'ArrowDown',
            'ArrowLeft', 'ArrowRight',
            'ArrowLeft', 'ArrowRight',
            'b',         'a'
        ];
    
        let matches = true;
        for (let i = 0; i < request.body.length; i++) {
            if (request.body[i] !== answer[i]) matches = false;
        }
    
        response.status(200).json({ flag: matches ? 'flag{30_lives_for_you_38201}' : 'I don\'t like cheaters! Do it right!' });

        const user = userManager.getUser(request.auth.id);
        if (matches && user.stage === 1) userManager.nextStage(request.auth.id);
    }
});

router.post('/stage2/login', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else {
        response.status(200).json({ error: 'Logins have been disabled by R3n3gad3s, but don\'t use password \'jobbin_pobbins\'!' });
    }
});

router.get('/stage3/init', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else {
        const user = userManager.getUser(request.auth.id);
        if (user.data.stage3) {
            user.data.stage3.lastPlayerScore = 0;
            user.data.stage3.lastCpuScore = 0;
        } else {
            user.data.stage3 = {
                lastPlayerScore: 0,
                lastCpuScore: 0,
                lastTime: new Date().getTime(),
                inTimeout: false
            };
        }
        response.sendStatus(200);
    }
});

router.post('/stage3/check', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else {
        const user = userManager.getUser(request.auth.id);

        const passedTime = new Date().getTime() - user.data.stage3.lastTime;
        if (user.data.stage3.inTimeout && passedTime < 300000) {
            response.status(200).json({ timeout: true, flag: `You are in a timeout! You have ${((300000 - passedTime) / 60000).toFixed(2)} minutes left and your score is reset!` });
            
            // reset player score
            user.data.stage3.lastPlayerScore = 0;
            user.data.stage3.lastCpuScore = 0;
        } else {
            user.data.stage3.inTimeout = false;
            user.data.stage3.lastTime = new Date().getTime();

            if (!request.body) {
                user.data.stage3.inTimeout = true;
                user.data.stage3.lastPlayerScore = 0;
                user.data.stage3.lastCpuScore = 0;
                response.status(200).json({ timeout: true, flag: 'Don\'t touch the endpoint! 5 minute timeout for you!' });
            } else {
                const ballXPosition = request.body.ballXPosition || request.body.var_29;
                const playerScore = request.body.playerScore || request.body.var_62;
                const cpuScore = request.body.cpuScore || request.body.var_95;
                const totalWidth = request.body.totalWidth || request.body.var_18;

                if (passedTime < 3000 && !firstScore) {
                    user.data.stage3.inTimeout = true;
                    user.data.stage3.lastPlayerScore = 0;
                    user.data.stage3.lastCpuScore = 0;
                    response.status(200).json({ timeout: true, flag: 'Don\'t spam the endpoint! 5 minute timeout for you!' });
                } else if (!ballXPosition && !playerScore && !cpuScore && !totalWidth) {
                    user.data.stage3.inTimeout = true;
                    user.data.stage3.lastPlayerScore = 0;
                    user.data.stage3.lastCpuScore = 0;
                    response.status(200).json({ timeout: true, flag: 'Don\'t touch the endpoint! 5 minute timeout for you!' });
                } else {
                    let flag = '';

                    if ((playerScore != 0 && cpuScore != 0) && Math.abs((playerScore - user.data.stage3.lastPlayerScore) + (cpuScore - user.data.stage3.lastCpuScore)) > 1) {
                        user.data.stage3.inTimeout = true;
                        user.data.stage3.lastPlayerScore = 0;
                        user.data.stage3.lastCpuScore = 0;
                        flag = 'I don\'t like score-changing cheaters! 5 minute timeout for you!';
                    }

                    if (playerScore - user.data.stage3.lastPlayerScore === 1 && Math.abs(totalWidth - ballXPosition) >= 30) {
                        user.data.stage3.inTimeout = true;
                        user.data.stage3.lastPlayerScore = 0;
                        user.data.stage3.lastCpuScore = 0;
                        flag = 'I don\'t like ball-moving cheaters! 5 minute timeout for you!';
                    }

                    if (!user.data.stage3.inTimeout) {
                        user.data.stage3.lastPlayerScore = playerScore;
                        user.data.stage3.lastCpuScore = cpuScore;

                        if (playerScore >= 5) {
                            flag = 'flag{hey_stop_looking_there_23912}';
                            if (user.stage === 3) userManager.nextStage(request.auth.id);
                        }
                    }
                    
                    response.status(200).json({ timeout: user.data.stage3.inTimeout, flag });
                }
            }
        }
    }
});

router.post('/stage4/request', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else {
        const forwarded = request.headers['X-Forwarded-For'] || request.headers['x-forwarded-for'];
    
        if (forwarded != '194.242.26.157') {
            response.status(200).json({ error: 'You are not in the correct location!' });
        } else {
            response.status(200).json({ flag: 'Flag: flag{so_no_headers_28013}' });

            const user = userManager.getUser(request.auth.id);
            if (user.stage === 4) userManager.nextStage(request.auth.id);
        }
    }
});

router.get('/stage6/init', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else {
        const user = userManager.getUser(request.auth.id);
        if (!user.data.stage6) {
            userManager.createDatabase(request.auth.id);
        }

        response.status(200).send('Please don\'t spam this endpoint, it does nothing for the challenge! - Alex');
    }
});

router.post('/stage6/create_ticket', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else {
        if (!request.body.summary || !request.body.description) {
            response.sendStatus(400);
        } else {
            try {
                userManager.insertTicket(request.auth.id, request.body);
                if (userManager.getModifiedTicket(request.auth.id)['TICKET_COMPLETE'] == 1) {
                    userManager.insertTicket(request.auth.id, { summary: 'The Flag', description: 'flag{legit_number_one_19373}' });
                    const user = userManager.getUser(request.auth.id);
                    if (user.stage === 6) userManager.nextStage(request.auth.id);
                }
                response.sendStatus(200);
            } catch (e) {
                response.sendStatus(500);
            }
        }
    }
});

router.get('/stage6/list_tickets', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else {
        response.status(200).json(userManager.getAllTickets(request.auth.id));
    }
});

router.get('/stage7/init', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else {
        const user = userManager.getUser(request.auth.id);
        let seed = Math.floor(Math.random() * Math.pow(2, 31));
        if (!user.data.stage7) {
            user.data.stage7 = { seed };
        } else {
            seed = user.data.stage7.seed;
        }
        user.data.stage7.started = new Date().getTime();
        
        const pieces = simulatePuzzle(user.data.stage7.seed);
        response.status(200).json({ pieces });
    }
});

router.post('/stage7/check', authenticate, (request, response) => {
    if (!request.auth || !userManager.getUser(request.auth.id)) {
        response.sendStatus(401);
    } else if (!request.body || !Array.isArray(request.body) || request.body.length === 0) {
        response.status(200).json({ flag: 'I don\'t like cheaters! Do it right!' });
    } else {
        const user = userManager.getUser(request.auth.id);
        if (!user.data.stage7) {
            response.sendStatus(401);
        } else {
            try {
                let passedTime = new Date().getTime() - user.data.stage7.started;
                if (passedTime > 5 * 60 * 1000) {
                    response.status(200).json({ flag: 'Sorry, time is up!' });
                } else if (checkPuzzle(user.data.stage7.seed, request.body)) {
                    response.status(200).json({ flag: 'flag{i_actually_wasnt_sorry_83911}' });
                    if (user.stage === 7) userManager.nextStage(request.auth.id);
                } else {
                    response.status(200).json({ flag: 'I don\'t like cheaters! Do it right!' });
                }
            } catch (e) {
                response.sendStatus(500);
            }
        }
    }
});

router.post('/stage8/send_notification', authenticate, (request, response) => {
    if (!request.auth) {
        response.sendStatus(401);
    } else {
        if (!request.body.message) {
            response.sendStatus(400);
        } else {
            let alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            const random = new Array(10).fill(0).map(_ => alphabet[Math.floor(Math.random() * alphabet.length)]).join('');
            fs.writeFile('logs/' + random + '.log', request.body.message + ' - From R3n3gad3s', (error) => {
                if (error) response.sendStatus(500);
                else response.sendStatus(200);
            });
        }
    }
});

router.get('/stage8/get_all_notifications', authenticate, (request, response) => {
    if (!request.auth) {
        response.sendStatus(401);
    } else {
        fs.readdir('logs', (error, files) => {
            if (error) response.sendStatus(500);
            response.status(200).json(files);
        });
    }
});

router.post('/stage8/show_notification', authenticate, (request, response) => {
    if (!request.auth) {
        response.sendStatus(401);
    } else {
        fs.readFile(request.body.file, (error, data) => {
            if (error) response.sendStatus(500);
            else response.status(200).json({ data });
        });
    }
});

const simulatePuzzle = (seed) => {
    let state = seed;
    const randomFloat = () => {
        state = (1103515245 * state + 12345) % Math.pow(2, 31);
        return state / Math.pow(2, 31);
    }

    const width = 32;
    const height = 20;
    let pieces = [];
    
    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            let index = y * width + x;
            pieces[index] = { x, y };
        }
    }

    for (let i = 0; i < pieces.length; i++) {
        let index = Math.floor(randomFloat() * pieces.length);
        let temp = JSON.stringify(pieces[i]);
        pieces[i] = pieces[index];
        pieces[index] = JSON.parse(temp);
    }
    
    return pieces;
}

const checkPuzzle = (seed, moves) => {
    const width = 32;
    const height = 20;
    const pieces = simulatePuzzle(seed);
    
    for (let i = 0; i < moves.length; i++) {
        let temp = JSON.stringify(pieces[moves[i].from]);
        pieces[moves[i].from] = pieces[moves[i].to];
        pieces[moves[i].to] = JSON.parse(temp);
    }

    let sorted = true;
    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            let index = y * width + x;
            if (!(pieces[index].x == x && pieces[index].y == y)) {
                sorted = false;
            }
        }
    }

    return sorted;
}

export default router;